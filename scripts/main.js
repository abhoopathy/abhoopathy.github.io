var MainView,bind=function(t,i){return function(){return t.apply(i,arguments)}};MainView=function(){t.prototype.resize=function(){var t;t=this.$tiles.width();return this.$tiles.css({height:t})};t.prototype.onGet=function(t){var i,e,a,o,n;o=jQuery.parseHTML(t);i=$(_.find(o,function(t){return t.nodeName==="DIV"}));e=i.find("[data-js-portfolio-piece]");e.attr("data-js-portfolio-piece-in-modal",true);this.$modalContent.fadeOut(100,function(t){return function(){t.$modalContent.html(e);return t.$modalContent.fadeIn(100)}}(this));this.$modal.show();this.$modalContent.scrollTop(0);_.defer(function(t){return function(){t.$modal.attr("data-js-modal-is-visible",true);return $("body").attr("data-js-modal-is-visible",true)}}(this));n=i.find("[data-js-modal-prev]").attr("href");a=i.find("[data-js-modal-next]").attr("href");$("[data-js-modal-prev] a").attr("href",n);return $("[data-js-modal-next] a").attr("href",a)};t.prototype.onTileClick=function(t){var i;i=$(t.target).closest("a").attr("href");if(i!=null){this.loadPage(i);t.preventDefault();return false}else{return true}};t.prototype.loadPage=function(t){return jQuery.get(t,{},this.onGet,"html")};t.prototype.onModalCloseClick=function(t){this.$modal.attr("data-js-modal-is-visible",false);$("body").attr("data-js-modal-is-visible",false);return _.delay(function(t){return function(){return t.$modal.hide()}}(this),250)};function t(){this.onModalCloseClick=bind(this.onModalCloseClick,this);this.loadPage=bind(this.loadPage,this);this.onTileClick=bind(this.onTileClick,this);this.onGet=bind(this.onGet,this);this.resize=bind(this.resize,this);this.$tiles=$("[data-js-tile]");this.$modal=$("[data-js-modal]");this.$modalContent=this.$modal.find("[data-js-modal-content]");this.$modalClose=this.$modal.find("[data-js-modal-close]");this.resize();$(window).on("resize",_.throttle(this.resize,50));this.$tiles.click(this.onTileClick);$("[data-js-modal-prev] a").click(this.onTileClick);$("[data-js-modal-next] a").click(this.onTileClick);this.$modalClose.click(this.onModalCloseClick)}return t}();$(function(){return window.mainView=new MainView});